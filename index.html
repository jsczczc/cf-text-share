<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>æ–‡æœ¬ç®¡ç†</title>
<style>
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  background: #f5f7fa;
}
.container {
  display: flex;
  height: 100vh;
}
.sidebar {
  width: 260px;
  background: #ffffff;
  border-right: 1px solid #ddd;
  padding: 15px;
  overflow-y: auto;
}
.sidebar h3 {
  margin-top: 0;
}
.doc-item {
  padding: 8px 10px;
  border-radius: 6px;
  cursor: pointer;
  margin-bottom: 4px;
}
.doc-item:hover {
  background: #e8f0fe;
}
.main {
  flex: 1;
  padding: 20px;
  display: flex;
  flex-direction: column;
}
.top-bar {
  display: flex;
  gap: 10px;
  margin-bottom: 10px;
}
input {
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
}
textarea {
  flex: 1;
  padding: 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 14px;
  line-height: 1.5;
  margin-top: 10px;
}
button {
  padding: 8px 14px;
  border-radius: 6px;
  border: none;
  background: #2563eb;
  color: white;
  cursor: pointer;
}
button:hover {
  background: #1d4ed8;
}
.link-box {
  margin-top: 8px;
  background: #eef2ff;
  padding: 8px;
  border-radius: 6px;
  font-size: 13px;
  word-break: break-all;
}
.copy-btn {
  margin-left: 10px;
  background: #10b981;
}
.copy-btn:hover {
  background: #059669;
}
.status {
  margin-top: 8px;
  font-size: 13px;
  color: green;
}
</style>
</head>
<body>

<div class="container">

  <!-- å·¦ä¾§æ–‡æ¡£åˆ—è¡¨ -->
  <div class="sidebar">
    <h3>ğŸ“„ æ–‡æ¡£åˆ—è¡¨</h3>
    <button style="width:100%;margin-bottom:10px" onclick="newDoc()">â• æ–°å»ºæ–‡æ¡£</button>
    <div id="list">åŠ è½½ä¸­...</div>
  </div>

  <!-- å³ä¾§ç¼–è¾‘åŒº -->
  <div class="main">
    <div class="top-bar">
      <input id="fileId" placeholder="è‡ªå®šä¹‰æ–‡æ¡£ IDï¼ˆå¿…å¡«ï¼‰" />
      <button onclick="autoId()">è‡ªåŠ¨ç”Ÿæˆ</button>
      <button onclick="save()">ğŸ’¾ ä¿å­˜</button>
    </div>

    <textarea id="content" placeholder="è¯·è¾“å…¥æ–‡æœ¬å†…å®¹..."></textarea>

    <div id="share" style="display:none" class="link-box"></div>
    <div id="status" class="status"></div>
  </div>

</div>

<script>
let currentId = null;

/* ç”Ÿæˆå¯è¯»æ€§æ›´å¥½çš„æ—¶é—´ID */
function autoId(){
  const d = new Date();
  const id =
    d.getFullYear().toString() +
    (d.getMonth()+1).toString().padStart(2,'0') +
    d.getDate().toString().padStart(2,'0') +
    d.getHours().toString().padStart(2,'0') +
    d.getMinutes().toString().padStart(2,'0') +
    d.getSeconds().toString().padStart(2,'0');

  document.getElementById('fileId').value = id;
}

/* åŠ è½½åˆ—è¡¨ */
async function loadList(){
  const res = await fetch('/api/list');
  const ids = await res.json();

  if (!ids.length){
    document.getElementById('list').innerHTML = 'æš‚æ— æ–‡æ¡£';
    return;
  }

  document.getElementById('list').innerHTML =
    ids.map(id => `<div class="doc-item" onclick="openDoc('${id}')">${id}</div>`).join('');
}

/* æ‰“å¼€æ–‡æ¡£ */
async function openDoc(id){
  currentId = id;
  document.getElementById('fileId').value = id;

  const res = aw
